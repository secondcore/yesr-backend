Ext.define("Ext.layout.container.Anchor",{alias:"layout.anchor",extend:"Ext.layout.container.Container",alternateClassName:"Ext.layout.AnchorLayout",type:"anchor",manageOverflow:2,renderTpl:["{%this.renderBody(out,values);this.renderPadder(out,values)%}"],defaultAnchor:"100%",parseAnchorRE:/^(r|right|b|bottom)$/i,beginLayout:function(c){var h=this,a=0,f,j,e,d,b,g;h.callParent(arguments);e=c.childItems;b=e.length;for(d=0;d<b;++d){j=e[d];f=j.target.anchorSpec;if(f){if(j.widthModel.calculated&&f.right){a|=1}if(j.heightModel.calculated&&f.bottom){a|=2}if(a==3){break}}}c.anchorDimensions=a;if(!Ext.supports.RightMargin&&!h.rightMarginCleanerFn){g=c.targetContext.el;h.rightMarginCleanerFn=Ext.Element.getRightMarginFixCleaner(g);g.addCls(Ext.baseCSSPrefix+"inline-children")}h.sanityCheck(c)},calculate:function(b){var a=this,c=a.getContainerSize(b);if(b.anchorDimensions!==b.state.calculatedAnchors){a.calculateAnchors(b,c)}if(b.hasDomProp("containerChildrenDone")){if(!c.gotAll){a.done=false}a.calculateContentSize(b,b.anchorDimensions);if(a.done){a.calculateOverflow(b,c,b.anchorDimensions);return}}a.done=false},calculateAnchors:function(g,a){var o=this,k=g.childItems,f=k.length,n=a.gotHeight,h=a.gotWidth,e=a.height,c=a.width,b=g.state,p=(h?1:0)|(n?2:0),l,r,m,q,j,d;b.calculatedAnchors=(b.calculatedAnchors||0)|p;for(j=0;j<f;j++){r=k[j];m=r.getMarginInfo();l=r.target.anchorSpec;if(h&&r.widthModel.calculated){d=l.right(c)-m.width;d=o.adjustWidthAnchor(d,r);r.setWidth(d)}if(n&&r.heightModel.calculated){q=l.bottom(e)-m.height;q=o.adjustHeightAnchor(q,r);r.setHeight(q)}}},finishedLayout:function(b){var a=this.rightMarginCleanerFn;if(a){delete this.rightMarginCleanerFn;b.targetContext.el.removeCls(Ext.baseCSSPrefix+"inline-children");a()}},sanityCheck:function(c){var h=c.widthModel.shrinkWrap,e=c.heightModel.shrinkWrap,b=c.childItems,f,g,j,d,a;for(d=0,a=b.length;d<a;++d){j=b[d];g=j.target;f=g.anchorSpec;if(f){if(j.widthModel.calculated&&f.right){if(h){Ext.log({level:"warn",msg:"Right anchor on "+g.id+" in shrinkWrap width container"})}}if(j.heightModel.calculated&&f.bottom){if(e){Ext.log({level:"warn",msg:"Bottom anchor on "+g.id+" in shrinkWrap height container"})}}}}},anchorFactory:{offset:function(a){return function(b){return b+a}},ratio:function(a){return function(b){return Math.floor(b*a)}},standard:function(a){return function(b){return b-a}}},parseAnchor:function(c,f,b){if(c&&c!="none"){var d=this.anchorFactory,e;if(this.parseAnchorRE.test(c)){return d.standard(b-f)}if(c.indexOf("%")!=-1){return d.ratio(parseFloat(c.replace("%",""))*0.01)}e=parseInt(c,10);if(!isNaN(e)){return d.offset(e)}}return null},adjustWidthAnchor:function(b,a){return b},adjustHeightAnchor:function(b,a){return b},configureItem:function(f){var e=this,a=e.owner,d=f.anchor,b,c,g;e.callParent(arguments);if(!f.anchor&&f.items&&!Ext.isNumber(f.width)&&!(Ext.isIE6&&Ext.isStrict)){f.anchor=d=e.defaultAnchor}if(a.anchorSize){if(typeof a.anchorSize=="number"){c=a.anchorSize}else{c=a.anchorSize.width;g=a.anchorSize.height}}else{c=a.initialConfig.width;g=a.initialConfig.height}if(d){b=d.split(" ");f.anchorSpec={right:e.parseAnchor(b[0],f.initialConfig.width,c),bottom:e.parseAnchor(b[1],f.initialConfig.height,g)}}},sizePolicy:{"":{setsWidth:0,setsHeight:0},b:{setsWidth:0,setsHeight:1},r:{"":{setsWidth:1,setsHeight:0},b:{setsWidth:1,setsHeight:1}}},getItemSizePolicy:function(c){var e=c.anchorSpec,a="",d=this.sizePolicy,b;if(e){b=this.owner.getSizeModel();if(e.right&&!b.width.shrinkWrap){d=d.r}if(e.bottom&&!b.height.shrinkWrap){a="b"}}return d[a]}});