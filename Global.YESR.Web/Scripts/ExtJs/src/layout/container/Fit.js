Ext.define("Ext.layout.container.Fit",{extend:"Ext.layout.container.Container",alternateClassName:"Ext.layout.FitLayout",alias:"layout.fit",itemCls:Ext.baseCSSPrefix+"fit-item",targetCls:Ext.baseCSSPrefix+"layout-fit",type:"fit",defaultMargins:{top:0,right:0,bottom:0,left:0},manageMargins:true,sizePolicies:{0:{setsWidth:0,setsHeight:0},1:{setsWidth:1,setsHeight:0},2:{setsWidth:0,setsHeight:1},3:{setsWidth:1,setsHeight:1}},getItemSizePolicy:function(b){var a=this.owner.getSizeModel(),c=(a.width.shrinkWrap?0:1)|(a.height.shrinkWrap?0:2);return this.sizePolicies[c]},beginLayoutCycle:function(d,o){var k=this,j=d.widthModel,h=d.heightModel,g=d.childItems,m=!j.shrinkWrap,a=!h.shrinkWrap,c=g.length,l=(d.targetContext.el.dom.tagName.toUpperCase()==="TD"),f,e,b,n;k.callParent(arguments);for(f=0;f<c;++f){b=g[f];if(!o){if(b.widthModel.calculated==m){e=null}else{e={widthModel:m?k.sizeModels.calculated:b.sizeModel.width}}if(b.heightModel.calculated!=a){(e||(e={})).heightModel=a?k.sizeModels.calculated:b.sizeModel.height}if(e){e.before=k.onBeforeInvalidateChild;b.invalidate(e)}}if(l){n=b.target.el.dom;if(b.heightModel.calculated){n.style.height=""}if(b.widthModel.calculated){n.style.width=""}}}},calculate:function(d){var j=this,h=d.childItems,b=h.length,c={contentWidth:0,contentHeight:0,length:b,ownerContext:d,targetSize:j.getContainerSize(d)},f=d.widthModel.shrinkWrap,l=d.heightModel.shrinkWrap,a=0,e=0,k,g;for(g=0;g<b;++g){c.index=g;j.fitItem(h[g],c)}if(l||f){k=d.targetContext.getPaddingInfo();if(f){a=k.width}if(l){e=k.height}}if(!d.setContentSize(c.contentWidth+a,c.contentHeight+e)){j.done=false}},fitItem:function(b,c){var a=this;if(b.invalid){a.done=false;return}c.margins=b.getMarginInfo();c.needed=c.got=0;a.fitItemWidth(b,c);a.fitItemHeight(b,c);if(c.got!=c.needed){a.done=false}},fitItemWidth:function(a,b){if(b.ownerContext.widthModel.shrinkWrap){b.contentWidth=Math.max(b.contentWidth,a.getProp("width")+b.margins.width)}else{if(a.widthModel.calculated){++b.needed;if(b.targetSize.gotWidth){++b.got;this.setItemWidth(a,b)}}}this.positionItemX(a,b)},fitItemHeight:function(a,b){if(b.ownerContext.heightModel.shrinkWrap){b.contentHeight=Math.max(b.contentHeight,a.getProp("height")+b.margins.height)}else{if(a.heightModel.calculated){++b.needed;if(b.targetSize.gotHeight){++b.got;this.setItemHeight(a,b)}}}this.positionItemY(a,b)},onBeforeInvalidateChild:function(b,a){++b.context.progressCount;if(a.widthModel){b.widthModel=a.widthModel}if(a.heightModel){b.heightModel=a.heightModel}},positionItemX:function(a,c){var b=c.margins;if(c.index||b.left){a.setProp("x",b.left)}if(b.width){a.setProp("margin-right",b.width)}},positionItemY:function(a,c){var b=c.margins;if(c.index||b.top){a.setProp("y",b.top)}if(b.height){a.setProp("margin-bottom",b.height)}},setItemHeight:function(a,b){a.setHeight(b.targetSize.height-b.margins.height)},setItemWidth:function(a,b){a.setWidth(b.targetSize.width-b.margins.width)}});